<main style="margin-top: 8%;">

    <div class="row g-2">
        <div style="padding:0px 20px;" class="col-lg-3 ">
            <div style="margin: 10px 0px;">
                <h7>CATEGORY</h7>
            </div>
            <ul class="list-group list-group-light">

                {{#each itemCategory}}
                <li id="item{{@key}}" onclick="searchCategory({{@key}})"
                    style="cursor: pointer ;background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center ">
                    {{name_category}}
                </li>

                {{/each}}
            </ul>
            <div style="margin: 20px 0px;">
                <h7>PRICE</h7>
            </div>
            <ul class="list-group list-group-light">
                <li style="background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center ">
                    30,001 - 50,000
                    <span class="badge badge-primary rounded-pill">47</span>
                </li>
                <li style="background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center">
                    50,001 - 75,000
                    <span class="badge badge-primary rounded-pill">77</span>
                </li>
                <li style="background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center">
                    75,001 - 1,00,000
                    <span class="badge badge-primary rounded-pill">37</span>
                </li>
                <li style="background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center">
                    1,00,001 - 2,00,000
                    <span class="badge badge-primary rounded-pill">33</span>
                </li>
            </ul>
            <div style="margin: 20px 0px;">
                <h7>BRAND</h7>
            </div>
            <ul class="list-group list-group-light">
                <li style="background-color: #000; font-size: 14px; color:#fff"
                    class="list-group-item d-flex justify-content-between align-items-center ">
                    Apple
                    <span class="badge badge-primary rounded-pill">16</span>
                </li>

            </ul>
        </div>
        <div class="col-lg-9 ">
            <div id="carouselExampleIndicators" class="carousel slide" data-bs-ride="carousel">
                <div class="carousel-indicators">
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="0"
                        class="active" aria-current="true" aria-label="Slide 1"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="1"
                        aria-label="Slide 2"></button>
                    <button type="button" data-bs-target="#carouselExampleIndicators" data-bs-slide-to="2"
                        aria-label="Slide 3"></button>
                </div>
                <div class="carousel-inner">
                    <div class="carousel-item active">
                        <img src="https://www.supreme.vip/home/iphone/iphone14/share-en.jpg" class="d-block w-100"
                            height="400">
                    </div>
                    <div class="carousel-item ">
                        <img src="https://www.91-cdn.com/hub/wp-content/uploads/2022/09/iphone-14-pro-max-hands-on.png"
                            class="d-block w-100" height="400" alt="...">
                    </div>
                    <div class="carousel-item">
                        <img src="https://taovietmy.vn/wp-content/uploads/2022/11/maxresdefault.jpg"
                            class="d-block w-100" height="400" alt="...">
                    </div>
                </div>
                <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleIndicators"
                    data-bs-slide="prev">
                    <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Previous</span>
                </button>
                <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleIndicators"
                    data-bs-slide="next">
                    <span class="carousel-control-next-icon" aria-hidden="true"></span>
                    <span class="visually-hidden">Next</span>
                </button>
            </div>


            <div style="margin-top: 28px;">
                <div class="row justify-content-center align-items-center g-2">

                    <div id="viewItem" class="row row-cols-1 row-cols-md-3 row-cols-lg-4 row-cols-sm-2 g-4">

                        {{#each itemProduct}}
                        <form action="/detail_product/{{_id}}" method="get">
                            <a style="text-decoration: none;" href="/detail_product/{{_id}}">
                                <div class="col">
                                    <div style="background-color: #aec1cf; " class="card">
                                        <div class="card-img">
                                            <img style="object-fit: cover;" width="163px" height="217px"
                                                src="/upload/{{image.[0]}}" class="card-img-top" alt="...">
                                        </div>
                                        <div class="card-info">
                                            <p class="text-body">{{name}}</p>

                                        </div>
                                        <div class="card-footer">
                                            <span style="color:#000" class="text-title">${{price}}</span>
                                            <div class="card-button">
                                                <svg class="svg-icon" viewBox="0 0 20 20">
                                                    <path
                                                        d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z">
                                                    </path>
                                                    <path
                                                        d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z">
                                                    </path>
                                                    <path
                                                        d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z">
                                                    </path>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </form>
                        {{/each}}
                    </div>
                </div>
            </div>
        </div>
    </div>
    </div>
    </div>
</main>
<script>
    var time = new Date();
    console.log(`Time: ${time.getTime()}`)
    console.log(`Time: ${time.toLocaleString()}`)

    async function searchCategory(index) {
        let text = document.querySelector(`#item${index}`).textContent.trim();


        var res = await fetch(`http://127.0.0.1:3000/api/product/category/${text}`, {
            method: 'GET',
            headers: {
                'Content-Type': 'application/json'
            }
        })
        const result = await res.json();
        console.log(result);
        const viewItem = document.getElementById('viewItem');
        if (result.length != 0) {
            viewItem.innerHTML = ''
            for (var i = 0; i < result.length; i++) {
                viewItem.innerHTML += `
                        <form action="/detail_product/${result[i]._id}" method="get">
                            <a style="text-decoration: none;" href="/detail_product/${result[i]._id}">
                                <div class="col">
                                    <div style="background-color: #aec1cf; " class="card">
                                        <div class="card-img">
                                            <img style="object-fit: cover;" width="163px" height="217px"
                                                src="/upload/${result[i].image[0]}" class="card-img-top" alt="...">
                                        </div>
                                        <div class="card-info">
                                            <p class="text-body">${result[i].name}</p>

                                            <p class="text-body">Category: ${result[i].category}</p>
                                        </div>
                                      
                                        <div class="card-footer">
                                            <span style="color:#000" class="text-title">$${result[i].price}</span>
                                            <div class="card-button">
                                                <svg class="svg-icon" viewBox="0 0 20 20">
                                                    <path
                                                        d="M17.72,5.011H8.026c-0.271,0-0.49,0.219-0.49,0.489c0,0.271,0.219,0.489,0.49,0.489h8.962l-1.979,4.773H6.763L4.935,5.343C4.926,5.316,4.897,5.309,4.884,5.286c-0.011-0.024,0-0.051-0.017-0.074C4.833,5.166,4.025,4.081,2.33,3.908C2.068,3.883,1.822,4.075,1.795,4.344C1.767,4.612,1.962,4.853,2.231,4.88c1.143,0.118,1.703,0.738,1.808,0.866l1.91,5.661c0.066,0.199,0.252,0.333,0.463,0.333h8.924c0.116,0,0.22-0.053,0.308-0.128c0.027-0.023,0.042-0.048,0.063-0.076c0.026-0.034,0.063-0.058,0.08-0.099l2.384-5.75c0.062-0.151,0.046-0.323-0.045-0.458C18.036,5.092,17.883,5.011,17.72,5.011z">
                                                    </path>
                                                    <path
                                                        d="M8.251,12.386c-1.023,0-1.856,0.834-1.856,1.856s0.833,1.853,1.856,1.853c1.021,0,1.853-0.83,1.853-1.853S9.273,12.386,8.251,12.386z M8.251,15.116c-0.484,0-0.877-0.393-0.877-0.874c0-0.484,0.394-0.878,0.877-0.878c0.482,0,0.875,0.394,0.875,0.878C9.126,14.724,8.733,15.116,8.251,15.116z">
                                                    </path>
                                                    <path
                                                        d="M13.972,12.386c-1.022,0-1.855,0.834-1.855,1.856s0.833,1.853,1.855,1.853s1.854-0.83,1.854-1.853S14.994,12.386,13.972,12.386z M13.972,15.116c-0.484,0-0.878-0.393-0.878-0.874c0-0.484,0.394-0.878,0.878-0.878c0.482,0,0.875,0.394,0.875,0.878C14.847,14.724,14.454,15.116,13.972,15.116z">
                                                    </path>
                                                </svg>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                        </form>
                      `

            }
        } else (
            viewItem.innerHTML = ' <h3 style="text-align: center; width:100%; margin: 100px 0px">No products</h3>'
        )
    }
</script>